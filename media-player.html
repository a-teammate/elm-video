<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <title>Sample Media Player using Elm Style Elements</title>
    <link href='media-player.css' rel='stylesheet' />
  </head>
  <div id="main"></div>
  <script src="elm.js"></script>
  <script>
    (function() {
      var app = Elm.Main.fullscreen();
      var videos = {};

      app.ports.videoEventStream.subscribe(function(event) {
        switch(event.kind) {
          case "setup":
            videos[event.id] = document.getElementById(event.id);
            console.log(videos[event.id]);
            videos[event.id].volume = event.volume;
            videos[event.id].muted = event.muted;
            videos[event.id].currentTime = event.position;
            if (!event.paused) videos[event.id].play();
            break;
          case "pause":
            videos[event.id].pause();
            console.log("Pausing");
            break;
          case "play":
            videos[event.id].play();
            console.log("Playing");
            break;
          case "stop":
            videos[event.id].pause();
            videos[event.id].currentTime = 0;
            console.log("Stopping");
            break;
          case "restart":
            videos[event.id].currentTime = 0;
            console.log("Restarting");
            break;
          case "volumedown":
            var newVolume = Math.max(videos[event.id].volume - 0.1, 0.0).toFixed(1);
            videos[event.id].volume = newVolume;
            console.log("Volume Down, at " + videos[event.id].volume);
            break;
          case "volumeup":
            var newVolume = Math.min(videos[event.id].volume + 0.1, 1.0).toFixed(1);
            videos[event.id].volume = newVolume;
            console.log("Volume Up, at " + videos[event.id].volume);
            break;
          case "mute":
            videos[event.id].muted = true;
            console.log("Mute");
            break;
          case "unmute":
            videos[event.id].muted = false;
            console.log("Unmute");
            break;
          case "seekto":
            videos[event.id].currentTime = event.position;
            console.log("Seeked to " + event.position);
            break;
          default:
            console.log("Unexpected event:");
            console.log(event);
        }
      });
    })();
  </script>
</html>
